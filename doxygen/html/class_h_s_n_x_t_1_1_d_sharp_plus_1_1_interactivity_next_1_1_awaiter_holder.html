<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HSNXT.DSharpPlus: HSNXT.DSharpPlus.InteractivityNext.AwaiterHolder&lt; TMachine, TEventArgs, TContextResult &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HSNXT.DSharpPlus
   </div>
   <div id="projectbrief">uwx&#39;s DSharpPlus Extensions</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('class_h_s_n_x_t_1_1_d_sharp_plus_1_1_interactivity_next_1_1_awaiter_holder.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_h_s_n_x_t_1_1_d_sharp_plus_1_1_interactivity_next_1_1_awaiter_holder-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">HSNXT.DSharpPlus.InteractivityNext.AwaiterHolder&lt; TMachine, TEventArgs, TContextResult &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Represents a wrapper class for hooking a state machine that contains an event listener, and then waiting for that state machine to error, finish or cancel execution, and then transparently unhooking that event listener. The wrapper takes care of ensuring the events are always hooked on the event target when necessary and unhooked in case there are no pending handlers, granting maximum performance and flexibility.  
 <a href="class_h_s_n_x_t_1_1_d_sharp_plus_1_1_interactivity_next_1_1_awaiter_holder.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a89894cee13aec6382dcc0514c32f43fc"><td class="memItemLeft" align="right" valign="top">delegate void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_h_s_n_x_t_1_1_d_sharp_plus_1_1_interactivity_next_1_1_awaiter_holder.html#a89894cee13aec6382dcc0514c32f43fc">SubscribeAction</a> (<a class="el" href="class_h_s_n_x_t_1_1_d_sharp_plus_1_1_interactivity_next_1_1_awaiter_holder.html">AwaiterHolder</a>&lt; TMachine, TEventArgs, TContextResult &gt; self)</td></tr>
<tr class="separator:a89894cee13aec6382dcc0514c32f43fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a019b11e9f4148377a3a63e943007f036"><td class="memItemLeft" align="right" valign="top"><a id="a019b11e9f4148377a3a63e943007f036"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>AwaiterHolder</b> (<a class="el" href="class_h_s_n_x_t_1_1_d_sharp_plus_1_1_interactivity_next_1_1_awaiter_holder.html#a89894cee13aec6382dcc0514c32f43fc">SubscribeAction</a> subscribe, <a class="el" href="class_h_s_n_x_t_1_1_d_sharp_plus_1_1_interactivity_next_1_1_awaiter_holder.html#a89894cee13aec6382dcc0514c32f43fc">SubscribeAction</a> unsubscribe)</td></tr>
<tr class="separator:a019b11e9f4148377a3a63e943007f036"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac74eeebbdb7cdba7e4937ead01f45e5f"><td class="memItemLeft" align="right" valign="top"><a id="ac74eeebbdb7cdba7e4937ead01f45e5f"></a>
async Task&#160;</td><td class="memItemRight" valign="bottom"><b>Trigger</b> (TEventArgs e)</td></tr>
<tr class="separator:ac74eeebbdb7cdba7e4937ead01f45e5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaac9d74c4e9895ef3aae32d2f4eb972d"><td class="memItemLeft" align="right" valign="top"><a id="aaac9d74c4e9895ef3aae32d2f4eb972d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>Subscribe</b> (TMachine handler)</td></tr>
<tr class="separator:aaac9d74c4e9895ef3aae32d2f4eb972d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87c4db11f8e1043629e132889e1bf393"><td class="memItemLeft" align="right" valign="top"><a id="a87c4db11f8e1043629e132889e1bf393"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>Unsubscribe</b> (TMachine handler)</td></tr>
<tr class="separator:a87c4db11f8e1043629e132889e1bf393"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5f807dfc937a5d5a7b65115bf72d9b7"><td class="memItemLeft" align="right" valign="top"><a id="af5f807dfc937a5d5a7b65115bf72d9b7"></a>
Task&lt; TContextResult &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>HandleAsync</b> (TMachine handler)</td></tr>
<tr class="separator:af5f807dfc937a5d5a7b65115bf72d9b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa44bb88a9e02569f235e2efc0f2a1e4f"><td class="memItemLeft" align="right" valign="top"><a id="aa44bb88a9e02569f235e2efc0f2a1e4f"></a>
async Task&lt; TContextResult &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>HandleCancellableAsync</b> (TMachine handler, CancellationToken? ct, TimeSpan timeout)</td></tr>
<tr class="separator:aa44bb88a9e02569f235e2efc0f2a1e4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Represents a wrapper class for hooking a state machine that contains an event listener, and then waiting for that state machine to error, finish or cancel execution, and then transparently unhooking that event listener. The wrapper takes care of ensuring the events are always hooked on the event target when necessary and unhooked in case there are no pending handlers, granting maximum performance and flexibility. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TMachine</td><td>The type of the state machine used for identifying when HandleCancellableAsync should return a value and unhook the event, or when it should continue working. See DiscordEventAwaiter&lt;TEventArgs,TContextResult&gt; for a complete implementation guide. </td></tr>
    <tr><td class="paramname">TEventArgs</td><td>The arguments of the event being hooked. This one is pretty self-explanatory. Events without parameters are not supported by <a class="el" href="class_h_s_n_x_t_1_1_d_sharp_plus_1_1_interactivity_next_1_1_awaiter_holder.html" title="Represents a wrapper class for hooking a state machine that contains an event listener,...">AwaiterHolder</a> since they have no way to discern one event from another. </td></tr>
    <tr><td class="paramname">TContextResult</td><td>The value that HandleCancellableAsync will return in case the <em>TMachine</em>  finishes successfully. </td></tr>
  </table>
  </dd>
</dl>
<p>There is a detailed explanation of how to initially hook the wrapper class at <a class="el" href="class_h_s_n_x_t_1_1_d_sharp_plus_1_1_interactivity_next_1_1_awaiter_holder.html#a89894cee13aec6382dcc0514c32f43fc">AwaiterHolder&lt;TMachine,TEventArgs,TContextResult&gt;.SubscribeAction</a>, and how to write a state machine at DiscordEventAwaiter&lt;TEventArgs,TContextResult&gt;, but it mostly boils down to this: </p><div class="fragment"><div class="line"><span class="keyword">private</span> <span class="keyword">class </span>MyVerifier : DiscordEventAwaiter\&lt;MyEventArgs, MyContext\&gt;</div><div class="line">{</div><div class="line">    <span class="keyword">private</span> readonly Func\&lt;MyEventArgs, Task\&lt;<span class="keywordtype">bool</span>\&gt;\&gt; _handler;</div><div class="line"></div><div class="line">    <span class="comment">// the use of a predicate here is completely optional</span></div><div class="line">    <span class="keyword">public</span> CancelVerifier(InteractivityExtension interactivity, Func\&lt;MyEventArgs, Task\&lt;<span class="keywordtype">bool</span>\&gt;\&gt; handler)</div><div class="line">        : base(interactivity)</div><div class="line">    {</div><div class="line">        _handler = handler;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keyword">protected</span> <span class="keyword">override</span> async Task\&lt;MyContext\&gt; CheckResult(MyEventArgs args)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">if</span> (await _handler(args))</div><div class="line">        {</div><div class="line">            <span class="keywordflow">return</span> <span class="keyword">new</span> MyContext</div><div class="line">            {</div><div class="line">                <span class="comment">// some information here...</span></div><div class="line">                MyCoolArgs = args</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="keywordflow">return</span> <span class="keyword">null</span>; <span class="comment">// event matching failed - don&#39;t unsubscribe the event handler</span></div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line">var verifierHolder = <span class="keyword">new</span> AwaiterHolder\&lt;MyVerifier, MyEventArgs, MyContext\&gt;(</div><div class="line">    ev =\&gt; obj.Event += ev.Trigger,</div><div class="line">    ev =\&gt; obj.Event -= ev.Trigger</div><div class="line">);</div><div class="line"></div><div class="line">var verifier = <span class="keyword">new</span> MyVerifier(<span class="keyword">this</span>, () =\&gt; <span class="keyword">true</span>);</div><div class="line">var result = await verifierHolder.HandleCancellableAsync(verifier, cancellationToken, myTimeout);</div><div class="line"><span class="comment">// result is null if timed out or cancellationToken was triggered, otherwise it&#39;s the MyContext instance we</span></div><div class="line"><span class="comment">// returned.</span></div></div><!-- fragment --> <div class="typeconstraint">
<dl><dt><b>Type Constraints</b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>TMachine</em></td><td>&#160;:</td><td valign="top"><em><a class="el" href="class_h_s_n_x_t_1_1_d_sharp_plus_1_1_interactivity_next_1_1_discord_event_awaiter.html">DiscordEventAwaiter</a></em></td><td>&#160;</td></tr>
<tr><td valign="top"><em>TMachine</em></td><td>&#160;:</td><td valign="top"><em>TEventArgs</em></td><td>&#160;</td></tr>
<tr><td valign="top"><em>TMachine</em></td><td>&#160;:</td><td valign="top"><em>TContextResult</em></td><td>&#160;</td></tr>
<tr><td valign="top"><em>TEventArgs</em></td><td>&#160;:</td><td valign="top"><em>DiscordEventArgs</em></td><td>&#160;</td></tr>
<tr><td valign="top"><em>TContextResult</em></td><td>&#160;:</td><td valign="top"><em><a class="el" href="class_h_s_n_x_t_1_1_d_sharp_plus_1_1_interactivity_next_1_1_interactivity_context.html">InteractivityContext</a></em></td><td>&#160;</td></tr>
</table>
</dd>
</dl>
</div>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a89894cee13aec6382dcc0514c32f43fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89894cee13aec6382dcc0514c32f43fc">&#9670;&nbsp;</a></span>SubscribeAction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">delegate void <a class="el" href="class_h_s_n_x_t_1_1_d_sharp_plus_1_1_interactivity_next_1_1_awaiter_holder.html">HSNXT.DSharpPlus.InteractivityNext.AwaiterHolder</a>&lt; TMachine, TEventArgs, TContextResult &gt;.SubscribeAction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_h_s_n_x_t_1_1_d_sharp_plus_1_1_interactivity_next_1_1_awaiter_holder.html">AwaiterHolder</a>&lt; TMachine, TEventArgs, TContextResult &gt;&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p></p>
<p>To be triggered with a AwaiterHolder&lt;TMachine,TEventArgs,TContextResult&gt; when the event handler for the event representing that instance is to be registered or unregistered. </p>
<p>Implementations should add or remove an event handler pointing to AwaiterHolder&lt;TMachine,TEventArgs,TContextResult&gt;.AwaiterHolder&lt;TMachine,TEventArgs,TContextResult&gt;.HandleAsync </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">self</td><td>The instance.</td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="keyword">new</span> AwaiterHolder\&lt;Machine, EventArgs, ContextResult\&gt;(</div><div class="line">    ev =\&gt; obj.Event += ev.Trigger,</div><div class="line">    ev =\&gt; obj.Event -= ev.Trigger</div><div class="line">);</div></div><!-- fragment --> 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>HSNXT.DSharpPlus.InteractivityNext/Entities/Events/AwaiterHolder.cs</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_h_s_n_x_t.html">HSNXT</a></li><li class="navelem"><a class="el" href="namespace_h_s_n_x_t_1_1_d_sharp_plus.html">DSharpPlus</a></li><li class="navelem"><a class="el" href="namespace_h_s_n_x_t_1_1_d_sharp_plus_1_1_interactivity_next.html">InteractivityNext</a></li><li class="navelem"><a class="el" href="class_h_s_n_x_t_1_1_d_sharp_plus_1_1_interactivity_next_1_1_awaiter_holder.html">AwaiterHolder</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
