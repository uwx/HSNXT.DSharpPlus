{"Name":"Format","Description":"string formator,replece string.Format","Author":"pedoc","SubmittedOn":"8/4/2015 9:45:05 AM","Entries":["/// <summary>\r\n        /// string formator,replece string.Format\r\n        /// </summary>\r\n        /// <example>string result = StrFormater.Format(@\"Hello @Name! Welcome to C#!\", new { Name = \"World\" });///</example>\r\n        /// <param name=\"template\"></param>\r\n        /// <param name=\"data\"></param>\r\n        /// <returns></returns>\r\n        public static string Format(this string template, object data)\r\n        {\r\n            return Regex.Replace(template, @\"@([\\w\\d]+)\", match => GetValue(match, data));\r\n        }\r\n\r\n        static string GetValue(Match match, object data)\r\n        {\r\n            var paraName = match.Groups[1].Value;\r\n            try\r\n            {\r\n                var proper = data.GetType().GetProperty(paraName);\r\n                return proper.GetValue(data).ToString();\r\n            }\r\n            catch (Exception)\r\n            {\r\n                var errMsg = string.Format(\"Not find'{0}'\", paraName);\r\n                throw new ArgumentException(errMsg);\r\n            }\r\n        }","string result = StrFormater.Format(@\"Hello @Name! Welcome to C#!\", new { Name = \"World\" });"]}