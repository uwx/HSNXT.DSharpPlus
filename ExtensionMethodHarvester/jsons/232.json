{"Name":"DataGridView columns visibility configuration window","Description":"This code allows you to change visibility of columns of any DataGridView component at program runtime. It shows simple window filled with list of columns of DataGridView. You can check columns on the list you want to be visible. Use this code with my other DataGridView extension methods http://extensionmethod.net/csharp/datagridview/load-save-configuration.","Author":"Marcin Kozub","SubmittedOn":"7/23/2013 11:06:59 PM","Entries":["using System.Windows.Forms;\r\n\r\nnamespace DataGridViewExtensions\r\n{\r\n    public static class DataGridViewExtensions\r\n    {\r\n        public static void ShowConfigurationWindow(this DataGridView dataGridView)\r\n        {\r\n            using (var frmConfig = new FrmColumnsConfig(dataGridView))\r\n            {\r\n                frmConfig.ShowDialog();\r\n            }\r\n        }\r\n    }\r\n\r\n    public class FrmColumnsConfig : Form\r\n    {\r\n        private DataGridView _dataGridView;\r\n\r\n        public FrmColumnsConfig(DataGridView dataGridView)\r\n        {\r\n            InitializeComponent();\r\n            _dataGridView = dataGridView;\r\n        }\r\n\r\n        protected override void OnLoad(System.EventArgs e)\r\n        {\r\n            base.OnLoad(e);\r\n            for (int i = 0; i < _dataGridView.Columns.Count; i++)\r\n            {\r\n                lstColumns.Items.Add(_dataGridView.Columns[i].HeaderText, _dataGridView.Columns[i].Visible);\r\n            }\r\n        }\r\n\r\n        private void lstColumns_ItemCheck(object sender, ItemCheckEventArgs e)\r\n        {\r\n            _dataGridView.Columns[e.Index].Visible = e.NewValue == CheckState.Checked;\r\n        }\r\n\r\n        private System.Windows.Forms.CheckedListBox lstColumns;\r\n        private System.ComponentModel.IContainer components = null;\r\n\r\n        private void InitializeComponent()\r\n        {\r\n            this.lstColumns = new System.Windows.Forms.CheckedListBox();\r\n            this.SuspendLayout();\r\n            this.lstColumns.Dock = System.Windows.Forms.DockStyle.Fill;\r\n            this.lstColumns.FormattingEnabled = true;\r\n            this.lstColumns.Location = new System.Drawing.Point(0, 0);\r\n            this.lstColumns.Name = \"lstColumns\";\r\n            this.lstColumns.Size = new System.Drawing.Size(258, 214);\r\n            this.lstColumns.TabIndex = 0;\r\n            this.lstColumns.CheckOnClick = true;\r\n            this.lstColumns.ItemCheck += new System.Windows.Forms.ItemCheckEventHandler(this.lstColumns_ItemCheck);\r\n\r\n            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);\r\n            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;\r\n            this.ClientSize = new System.Drawing.Size(258, 214);\r\n            this.Controls.Add(this.lstColumns);\r\n            this.Name = \"FrmColumnsConfig\";\r\n            this.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;\r\n            this.Text = \"Columns configuration\";\r\n            this.ResumeLayout(false);\r\n        }\r\n\r\n        protected override void Dispose(bool disposing)\r\n        {\r\n            if (disposing && (components != null))\r\n            {\r\n                components.Dispose();\r\n            }\r\n            base.Dispose(disposing);\r\n        }\r\n    }\r\n}","dgvInstance.ShowConfigurationWindow();"]}