{"Name":"DateDiff","Description":"DateDiff in SQL style. The following DateParts are implemented: - \"year\" (abbr. \"yy\", \"yyyy\") - \"quarter\" (abbr. \"qq\", \"q\") - \"month\" (abbr. \"mm\", \"m\") - \"day\" (abbr. \"dd\", \"d\") - \"week\" (abbr. \"wk\", \"ww\") - \"hour\" (abbr. \"hh\") - \"minute\" (abbr. \"mi\", \"n\") - \"second\" (abbr. \"ss\", \"s\") - \"millisecond\" (abbr. \"ms\")","Author":"Jonnidip","SubmittedOn":"6/8/2009 10:06:37 AM","Entries":["/// <summary>\r\n/// DateDiff in SQL style. \r\n/// Datepart implemented: \r\n///     \"year\" (abbr. \"yy\", \"yyyy\"), \r\n///     \"quarter\" (abbr. \"qq\", \"q\"), \r\n///     \"month\" (abbr. \"mm\", \"m\"), \r\n///     \"day\" (abbr. \"dd\", \"d\"), \r\n///     \"week\" (abbr. \"wk\", \"ww\"), \r\n///     \"hour\" (abbr. \"hh\"), \r\n///     \"minute\" (abbr. \"mi\", \"n\"), \r\n///     \"second\" (abbr. \"ss\", \"s\"), \r\n///     \"millisecond\" (abbr. \"ms\").\r\n/// </summary>\r\n/// <param name=\"DatePart\"></param>\r\n/// <param name=\"EndDate\"></param>\r\n/// <returns></returns>\r\npublic static Int64 DateDiff(this DateTime StartDate, String DatePart, DateTime EndDate)\r\n{\r\n    Int64 DateDiffVal = 0;\r\n    System.Globalization.Calendar cal = System.Threading.Thread.CurrentThread.CurrentCulture.Calendar;\r\n    TimeSpan ts = new TimeSpan(EndDate.Ticks - StartDate.Ticks);\r\n    switch (DatePart.ToLower().Trim())\r\n    {\r\n        #region year\r\n        case \"year\":\r\n        case \"yy\":\r\n        case \"yyyy\":\r\n            DateDiffVal = (Int64)(cal.GetYear(EndDate) - cal.GetYear(StartDate));\r\n            break;\r\n        #endregion\r\n\r\n        #region quarter\r\n        case \"quarter\":\r\n        case \"qq\":\r\n        case \"q\":\r\n            DateDiffVal = (Int64)((((cal.GetYear(EndDate)\r\n                                - cal.GetYear(StartDate)) * 4)\r\n                                + ((cal.GetMonth(EndDate) - 1) / 3))\r\n                                - ((cal.GetMonth(StartDate) - 1) / 3));\r\n            break;\r\n        #endregion\r\n\r\n        #region month\r\n        case \"month\":\r\n        case \"mm\":\r\n        case \"m\":\r\n            DateDiffVal = (Int64)(((cal.GetYear(EndDate)\r\n                                - cal.GetYear(StartDate)) * 12\r\n                                + cal.GetMonth(EndDate))\r\n                                - cal.GetMonth(StartDate));\r\n            break;\r\n        #endregion\r\n\r\n        #region day\r\n        case \"day\":\r\n        case \"d\":\r\n        case \"dd\":\r\n            DateDiffVal = (Int64)ts.TotalDays;\r\n            break;\r\n        #endregion\r\n\r\n        #region week\r\n        case \"week\":\r\n        case \"wk\":\r\n        case \"ww\":\r\n            DateDiffVal = (Int64)(ts.TotalDays / 7);\r\n            break;\r\n        #endregion\r\n\r\n        #region hour\r\n        case \"hour\":\r\n        case \"hh\":\r\n            DateDiffVal = (Int64)ts.TotalHours;\r\n            break;\r\n        #endregion\r\n\r\n        #region minute\r\n        case \"minute\":\r\n        case \"mi\":\r\n        case \"n\":\r\n            DateDiffVal = (Int64)ts.TotalMinutes;\r\n            break;\r\n        #endregion\r\n\r\n        #region second\r\n        case \"second\":\r\n        case \"ss\":\r\n        case \"s\":\r\n            DateDiffVal = (Int64)ts.TotalSeconds;\r\n            break;\r\n        #endregion\r\n\r\n        #region millisecond\r\n        case \"millisecond\":\r\n        case \"ms\":\r\n            DateDiffVal = (Int64)ts.TotalMilliseconds;\r\n            break;\r\n        #endregion\r\n\r\n        default:\r\n            throw new Exception(String.Format(\"DatePart \\\"{0}\\\" is unknown\", DatePart));\r\n    }\r\n    return DateDiffVal;\r\n}","// Gets the total days from 01/01/2000.\r\nDateTime dt = new DateTime(2000, 01, 01);\r\nInt64 days = dt.DateDiff(\"day\", DateTime.Now);\r\n// Gets the total hours from 01/01/2000.\r\nInt64 hours = dt.DateDiff(\"hour\", DateTime.Now);"]}