{"Name":"UpdateCollection","Description":"Updates items from the collection using a modified version of this collection. Useful in MVVM scenarios needing cancellable edition and delayed persistence.","Author":"Lionel Ringenbach","SubmittedOn":"10/13/2011 11:31:19 AM","Entries":["public static void UpdateCollection<T>(this ICollection<T> originalCollection, ICollection<T> updatedCollection)\r\n{\r\n    if (originalCollection.IsReadOnly)\r\n    {\r\n        throw new InvalidOperationException(\"Cannot update a read-only collection.\");\r\n    }\r\n\r\n    Collection<T> oldItems = new Collection<T>();\r\n    Collection<T> newItems = new Collection<T>();\r\n\r\n    foreach (var originalItem in originalCollection)\r\n    {\r\n        if (!updatedCollection.Contains(originalItem))\r\n        {\r\n            oldItems.Add(originalItem);\r\n        }\r\n    }\r\n\r\n    foreach (var updatedItem in updatedCollection)\r\n    {\r\n        if (!originalCollection.Contains(updatedItem))\r\n        {\r\n            newItems.Add(updatedItem);\r\n        }\r\n    }\r\n\r\n    foreach (var oldItem in oldItems)\r\n    {\r\n        originalCollection.Remove(oldItem);\r\n    }\r\n\r\n    foreach (var newItem in newItems)\r\n    {\r\n        originalCollection.Add(newItem);\r\n    }\r\n}","ObservableCollection<Uri> links = new ObservableCollection<Uri>(originalLinks)\r\n\r\n...\r\n\r\n// Do some operations on the collection\r\n\r\n...\r\n\r\noriginalLinks.UpdateCollection(links);"]}