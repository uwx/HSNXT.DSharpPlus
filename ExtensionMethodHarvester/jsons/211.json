{"Name":"Modify Querystring","Description":"Modify the querystring of the current URL (or a passed in URL) to either add, update or remove parameters.","Author":"Chris Pratt","SubmittedOn":"7/7/2014 10:54:58 PM","Entries":["public static class UrlHelperExtensions\r\n{\r\n\tpublic static string ModifyQueryString(this UrlHelper helper, NameValueCollection updates, IEnumerable<string> removes)\r\n\t{\r\n\t\treturn ModifyQueryString(helper, null, updates, removes);\r\n\t}\r\n\r\n\tpublic static string ModifyQueryString(this UrlHelper helper, string url, NameValueCollection updates, IEnumerable<string> removes)\r\n\t{\r\n\t\tNameValueCollection query;\r\n\t\tvar request = helper.RequestContext.HttpContext.Request;\r\n\r\n\t\tif (string.IsNullOrWhiteSpace(url))\r\n\t\t{\r\n\t\t\turl = request.Url.AbsolutePath;\r\n\t\t\tquery = HttpUtility.ParseQueryString(request.QueryString.ToString());\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tvar urlParts = url.Split('?');\r\n\t\t\turl = urlParts[0];\r\n\t\t\tif (urlParts.Length > 1)\r\n\t\t\t{\r\n\t\t\t\tquery = HttpUtility.ParseQueryString(urlParts[1]);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tquery = new NameValueCollection();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tupdates = updates ?? new NameValueCollection();\r\n\t\tforeach (string key in updates.Keys)\r\n\t\t{\r\n\t\t\tquery.Set(key, updates[key]);\r\n\t\t}\r\n\r\n\t\tremoves = removes ?? new List<string>();\r\n\t\tforeach (string param in removes)\r\n\t\t{\r\n\t\t\tquery.Remove(param);\r\n\t\t}\r\n\r\n\t\tif (query.HasKeys())\r\n\t\t{\r\n\t\t\treturn string.Format(\"{0}?{1}\", url, query.ToString());\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\treturn url;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static string UpdateQueryParam(this UrlHelper helper, string param, object value)\r\n\t{\r\n\t\treturn ModifyQueryString(helper, new NameValueCollection { { param, value.ToString() } }, null);\r\n\t}\r\n\r\n\tpublic static string UpdateQueryParam(this UrlHelper helper, string url, string param, object value)\r\n\t{\r\n\t\treturn ModifyQueryString(helper, url, new NameValueCollection { { param, value.ToString() } }, null);\r\n\t}\r\n\r\n\tpublic static string RemoveQueryParam(this UrlHelper helper, string param)\r\n\t{\r\n\t\treturn ModifyQueryString(helper, null, new List<string> { param });\r\n\t}\r\n\r\n\tpublic static string UpdateQueryParams(this UrlHelper helper, NameValueCollection updates)\r\n\t{\r\n\t\treturn ModifyQueryString(helper, updates, null);\r\n\t}\r\n\r\n\tpublic static string RemoveQueryParams(this UrlHelper helper, List<string> removes)\r\n\t{\r\n\t\treturn ModifyQueryString(helper, null, removes);\r\n\t}\r\n}","Url.UpdateQueryParam(\"page\", 4)\r\n\r\nUrl.RemoveQueryParam(\"q\");"]}