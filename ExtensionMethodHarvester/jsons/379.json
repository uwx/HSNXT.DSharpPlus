{"Name":"GetPropertyValue<T>","Description":"Get the base value of CrmProperty object. This is used for interacting with DynamicEntity on Microsoft CRM.","Author":"Dimaz Pramudya","SubmittedOn":"12/20/2009 12:15:59 AM","Entries":["public static T GetPropertyValue<T>(this DynamicEntity entity, string propertyName)\r\n        {\r\n            // Retrieve the matching property.\r\n            object theProperty = entity.Properties.FirstOrDefault(i => i.Name.EqualsIgnoreCase(propertyName));\r\n\r\n            // If property not found, return the default value.\r\n            if (theProperty == null) return default(T);\r\n\r\n            object value = null;\r\n            string strPropertyType = theProperty.GetType().Name;\r\n\r\n            switch (strPropertyType)\r\n            {\r\n                case \"KeyProperty\":\r\n                    value = ((KeyProperty)theProperty).Value.Value;\r\n                    break;\r\n\r\n                case \"StringProperty\":\r\n                    value = ((StringProperty)theProperty).Value;\r\n                    break;\r\n\r\n                case \"PicklistProperty\":\r\n                    if (typeof(T).Equals(typeof(string)))\r\n                        value = ((PicklistProperty)theProperty).Value.name;\r\n                    else if (typeof(T).Equals(typeof(int)))\r\n                        value = ((PicklistProperty)theProperty).Value.Value;\r\n\r\n                    break;\r\n\r\n                case \"CrmBooleanProperty\":\r\n                    value = ((CrmBooleanProperty)theProperty).Value.Value;\r\n                    break;\r\n\r\n                case \"CrmDateTimeProperty\":\r\n                    value = ((CrmDateTimeProperty)theProperty).Value.Value;\r\n                    break;\r\n\r\n                case \"CrmDecimalProperty\":\r\n                    value = ((CrmDecimalProperty)theProperty).Value.Value;\r\n                    break;\r\n\r\n                case \"CrmFloatProperty\":\r\n                    value = ((CrmFloatProperty)theProperty).Value.Value;\r\n                    break;\r\n\r\n                case \"CrmMoneyProperty\":\r\n                    value = ((CrmMoneyProperty)theProperty).Value.Value;\r\n                    break;\r\n\r\n                case \"CrmNumberProperty\":\r\n                    value = ((CrmNumberProperty)theProperty).Value.Value;\r\n                    break;\r\n\r\n                case \"LookupProperty\":\r\n                    if (typeof(T).Equals(typeof(string)))\r\n                        value = ((LookupProperty)theProperty).Value.name;\r\n                    else if (typeof(T).Equals(typeof(Guid)))\r\n                        value = ((LookupProperty)theProperty).Value.Value;\r\n\r\n                    break;\r\n\r\n                case \"CustomerProperty\":\r\n                    if (typeof(T).Equals(typeof(string)))\r\n                        value = ((CustomerProperty)theProperty).Value.name;\r\n                    else if (typeof(T).Equals(typeof(Guid)))\r\n                        value = ((CustomerProperty)theProperty).Value.Value;\r\n\r\n                    break;\r\n\r\n                case \"StatusProperty\":\r\n                    if (typeof(T).Equals(typeof(string)))\r\n                        value = ((StatusProperty)theProperty).Value.name;\r\n                    else if (typeof(T).Equals(typeof(Guid)))\r\n                        value = ((StatusProperty)theProperty).Value.Value;\r\n\r\n                    break;\r\n\r\n                case \"StateProperty\":\r\n                    value = ((StateProperty)theProperty).Value;\r\n                    break;\r\n\r\n                case \"EntityNameReferenceProperty\":\r\n                    value = ((EntityNameReferenceProperty)theProperty).Value.Value;\r\n                    break;\r\n            }\r\n\r\n            try\r\n            {\r\n                if (value != null)\r\n                {\r\n                    return (T)value;\r\n                }\r\n            }\r\n            catch\r\n            { }\r\n\r\n            return default(T);\r\n        }","var dynamicContact = ...;\r\ndynamicContact.GetPropertyValue<string>(\"firstname\");\r\n\r\n// Will retrieve the user id that modified this record last.\r\ndynamicContact.GetPropertyValue<Guid>(\"modifiedby\");\r\n\r\n// Will retrieve the username that modified this record last.\r\ndynamicContact.GetPropertyValue<string>(\"modifiedby\");"]}