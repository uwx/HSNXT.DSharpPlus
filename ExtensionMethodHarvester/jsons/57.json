{"Name":"Log SharePoint Exception via SPDiagnosticsService","Description":"Log SharePoint Exception via SPDiagnosticsService for Debugging (result : 0000 Unexpected My Method Name : Attempted to divide by zero. 220da18b-1517-4230-90ac-91117ceaea33 )","Author":"http://mb-seifollahi.ir","SubmittedOn":"3/31/2013 7:47:38 AM","Entries":["// Need namespace => using Microsoft.SharePoint.Administration;\r\npublic static void SPTraceLogError(this Exception ex)\r\n        {\r\n            SPDiagnosticsService.Local.WriteTrace(0, new SPDiagnosticsCategory(\"My Category Name\",\r\n            TraceSeverity.High, EventSeverity.Error),\r\n            TraceSeverity.Unexpected, ex.Message, ex.StackTrace);\r\n        }\r\n\r\npublic static void SPTraceLogError(this Exception ex , string keyNote)\r\n        {\r\n            SPDiagnosticsService.Local.WriteTrace(0, new SPDiagnosticsCategory(\"My Category Name\",\r\n            TraceSeverity.High, EventSeverity.Error),\r\n            TraceSeverity.Unexpected,keyNote+\" : \"+ ex.Message, ex.StackTrace);\r\n        }","try\r\n                    {\r\n                      // My Code \r\n                    }\r\n                    catch (Exception ex)\r\n                    {\r\n                        ex.SPTraceLogError();\r\n                        // OR\r\n                        //ex.SPTraceLogError(\"My Method Name\");\r\n                    }"]}