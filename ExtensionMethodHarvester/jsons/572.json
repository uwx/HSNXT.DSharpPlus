{"Name":"GetTotalMonthDiff","Description":"Compute dateTime difference precisely","Author":"Alex-LEWIS","SubmittedOn":"8/12/2015 3:26:00 PM","Entries":["/// <summary>\r\n/// Compute dateTime difference precisely\r\n/// Alex-LEWIS, 2015-08-11\r\n/// </summary>\r\n/// <param name=\"dt1\"></param>\r\n/// <param name=\"dt2\"></param>\r\n/// <returns></returns>\r\npublic static double GetTotalMonthDiff(this DateTime dt1, DateTime dt2)\r\n{\r\n  var l = dt1 < dt2 ? dt1 : dt2;\r\n  var r = dt1 >= dt2 ? dt1 : dt2;\r\n  var lDfM = DateTime.DaysInMonth(l.Year, l.Month);\r\n  var rDfM = DateTime.DaysInMonth(r.Year, r.Month);\r\n\r\n  var dayFixOne = l.Day == r.Day\r\n    ? 0d\r\n    : l.Day > r.Day\r\n      ? r.Day * 1d / rDfM - l.Day * 1d / lDfM\r\n      : (r.Day - l.Day) * 1d / rDfM;\r\n\r\n  return dayFixOne\r\n    + (l.Month == r.Month ? 0 : r.Month - l.Month)\r\n    + (l.Year == r.Year ? 0 : (r.Year - l.Year) * 12);\r\n}","DateTime dt1 = new DateTime(2015, 08, 11);\r\nDateTime dt2 = new DateTime(1992, 10, 10);\r\nvar monthTotalDiff = dt1.GetMonthDiff(dt2);"]}