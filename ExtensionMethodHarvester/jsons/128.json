{"Name":"AsEnumerable","Description":"Allows you to treat an IDataReader from a database query as enumerable so that you can perform LINQ operations on it.","Author":"James Michael Hare","SubmittedOn":"10/20/2010 11:22:18 PM","Entries":["using System.Collections.Generic;\r\nusing System.Data;\r\n\r\n\r\n// A set of extension methods for IDataReader\r\npublic static class DataReaderExtensions\r\n{\r\n\t// Enumerates through the reads in an IDataReader.\r\n\tpublic static IEnumerable<IDataRecord> AsEnumerable(this IDataReader reader)\r\n\t{\r\n\t\twhile (reader.Read())\r\n\t\t{\r\n\t\t\tyield return reader;\r\n\t\t}\r\n\t}\r\n}","using (var connection = new SqlConnection(\"some connection string\"))\r\n\t\t\tusing (var command = new SqlCommand(\"select * from products\", connection))\r\n\t\t\t{\r\n\t\t\t\tconnection.Open();\r\n\r\n\t\t\t\tusing (var reader = command.ExecuteReader())\r\n\t\t\t\t{\r\n\t\t\t\t\tvar results = reader.AsEnumerable()\r\n\t\t\t\t\t\t.Select(record => new Product\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tName = (string)record[\"product_name\"],\r\n\t\t\t\t\t\t\t\t\t\tId = (int)record[\"product_id\"],\r\n\t\t\t\t\t\t\t\t\t\tCategory = (string)record[\"product_category\"]\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.GroupBy(product => product.Category);\r\n\t\t\t\t}\r\n\t\t\t}"]}