{"Name":"ToDataTable","Description":"Converts an IEnumerable to DataTable (supports nullable types) adapted from http://www.c-sharpcorner.com/UploadFile/VIMAL.LAKHERA/LINQResultsetToDatatable06242008042629AM/LINQResultsetToDatatable.aspx","Author":"Ewerton Luis de Mattos","SubmittedOn":"12/10/2009 12:30:33 PM","Entries":["public static DataTable ToDataTable<T>(this IEnumerable<T> varlist)\r\n        {\r\n            DataTable dtReturn = new DataTable();\r\n\r\n            // column names \r\n            PropertyInfo[] oProps = null;\r\n\r\n            if (varlist == null) return dtReturn;\r\n\r\n            foreach (T rec in varlist)\r\n            {\r\n                // Use reflection to get property names, to create table, Only first time, others will follow \r\n                if (oProps == null)\r\n                {\r\n                    oProps = ((Type)rec.GetType()).GetProperties();\r\n                    foreach (PropertyInfo pi in oProps)\r\n                    {\r\n                        Type colType = pi.PropertyType;\r\n\r\n                        if ((colType.IsGenericType) && (colType.GetGenericTypeDefinition() == typeof(Nullable<>)))\r\n                        {\r\n                            colType = colType.GetGenericArguments()[0];\r\n                        }\r\n\r\n                        dtReturn.Columns.Add(new DataColumn(pi.Name, colType));\r\n                    }\r\n                }\r\n\r\n                DataRow dr = dtReturn.NewRow();\r\n\r\n                foreach (PropertyInfo pi in oProps)\r\n                {\r\n                    dr[pi.Name] = pi.GetValue(rec, null) == null ? DBNull.Value : pi.GetValue\r\n                    (rec, null);\r\n                }\r\n\r\n                dtReturn.Rows.Add(dr);\r\n            }\r\n            return dtReturn;\r\n        }","// It will result an IQueryable (IEnumerable)\r\nvar result = from c in db.customer\r\n             where c.id = 26\r\n             select c;\r\n\r\nDataTable dtResults = new DataTable();\r\ndtResults = result.ToDataTable();"]}