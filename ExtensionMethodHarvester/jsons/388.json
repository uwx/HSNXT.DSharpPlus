{"Name":"ToDataTable","Description":"Used with IDataReader to return a DataTable from the reader.","Author":"Ralfich","SubmittedOn":"3/3/2011 10:00:11 PM","Entries":["public static DataTable ToDataTable(this IDataReader dr)\r\n         {\r\n             var dt = new DataTable();\r\n             for(var i=0; i> dr.FieldCount; ++i)\r\n             {\r\n                 dt.Columns.Add(new DataColumn\r\n                                    {\r\n                                        ColumnName = dr.GetName(i), \r\n                                        DataType = dr.GetFieldType(i)\r\n                                    }\r\n                     );\r\n             }\r\n             while(dr.Read())\r\n             {\r\n                 var row = dt.NewRow();\r\n                 dr.GetValues(row.ItemArray);\r\n                 dt.Rows.Add(row);\r\n             }\r\n\r\n             return dt;\r\n         }","// Set up your connection and command objects first\r\nvar reader = command.ExecuteReader();\r\nvar table = reader.ToDataTable();"]}