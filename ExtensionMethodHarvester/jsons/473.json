{"Name":"FromAppSettings","Description":"Get a value from AppSettings section of Web.Config and change its type to the correct one or return a default value in case the key doesn't exists.","Author":"Adri√°n Maillo","SubmittedOn":"11/10/2014 10:02:01 PM","Entries":["public static T FromAppSettings<T>(this string key, T defaultValue = default(T)) where T : IConvertible\r\n{\r\n\tif (string.IsNullOrWhiteSpace(key))\r\n\t\treturn defaultValue;\r\n\r\n\tvar value = ConfigurationManager.AppSettings[key];\r\n\r\n\tif (string.IsNullOrWhiteSpace(value))\r\n\t\treturn defaultValue;\r\n\r\n\tvar tc = Type.GetTypeCode(typeof(T));\r\n\r\n\tswitch (tc)\r\n\t{\r\n\t\tcase TypeCode.Boolean:\r\n\t\tcase TypeCode.Byte:\r\n\t\tcase TypeCode.DateTime:\r\n\t\tcase TypeCode.Decimal:\r\n\t\tcase TypeCode.Double:\r\n\t\tcase TypeCode.Int16:\r\n\t\tcase TypeCode.Int32:\r\n\t\tcase TypeCode.Int64:\r\n\t\tcase TypeCode.String:\r\n\t\t\tT output;\r\n\t\t\ttry\r\n\t\t\t{\r\n\t\t\t\toutput = (T)Convert.ChangeType(value, tc);\r\n\t\t\t}\r\n\t\t\tcatch\r\n\t\t\t{\r\n\t\t\t\toutput = defaultValue;\r\n\t\t\t}\r\n\r\n\t\t\treturn output;\r\n\r\n\t\tdefault:\r\n\t\t\tthrow new NotSupportedException();\r\n\t}\r\n}","//Example 1\r\nvar email = \"EMail\".FromAppSettings(string.Empty);\r\n\r\n//Example 2\r\nvar email = \"EMail\".FromAppSettings(\"noreply@extensionmethod.net\");\r\n\r\n//Example 3\r\nvar id = \"AppID\".FromAppSettings(int.MinValue);"]}