{"Name":"ToInteger","Description":"Convert datatable field to int32","Author":"David Silva ( invalidtruck)","SubmittedOn":"10/25/2012 6:41:31 PM","Entries":["/// <summary>\r\n        /// Convierte de Double a Int \r\n        /// </summary>\r\n        /// <param name=\"file\">Datarow</param>\r\n        /// <param name=\"columna\">Index de la columna</param>\r\n        /// <param name=\"tipo\"></param>\r\n        /// <returns></returns>\r\n        public static Int32 ToInteger(this DataRow file,int columna)\r\n        {\r\n\r\n            try\r\n            {\r\n                if (file.ItemArray[columna].GetType().Name == \"Decimal\")\r\n                {\r\n                    return Convert.ToInt32(file.Field<Decimal>(columna));\r\n                }\r\n                if (file.ItemArray[columna].GetType().Name == \"String\")\r\n                {\r\n                    return Convert.ToInt32(file.Field<String>(columna));\r\n                }\r\n                if (file.ItemArray[columna].GetType().Name == \"Double\")\r\n                {\r\n                    return Convert.ToInt32(file.Field<Double>(columna));\r\n                }\r\n                if (file.ItemArray[columna].GetType().Name == \"Float\")\r\n                {\r\n                    return Convert.ToInt32(file.Field<float>(columna));\r\n                }\r\n                else\r\n                {\r\n                    return Convert.ToInt32(file.Field<Object>(columna));\r\n                }\r\n            }\r\n\r\n            catch (InvalidCastException ecast)\r\n            { throw ecast; }\r\n            catch (IndexOutOfRangeException iore)\r\n            { throw iore; }\r\n            catch (NullReferenceException f)\r\n            { throw f; }\r\n        }","var query1 = dtModel.AsEnumerable().Select(d => new\r\n                {                    \r\n                    iserie =  d.Field<String>(0),\r\n                    iBegin= d.ToInteger(1),\r\n                    iNow = d.ToInteger(2),\r\n                    iLess =d.ToInteger(3)                   \r\n\r\n                });"]}