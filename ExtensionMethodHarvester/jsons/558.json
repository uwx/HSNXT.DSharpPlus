{"Name":"ToMouseInfo","Description":"Converts a complex multitouch, pressure sensitive silverlight stylus object to a simple MouseInfo object.","Author":"Loek van den Ouweland","SubmittedOn":"12/18/2007 5:32:56 PM","Entries":["using System;\r\nusing System.Windows;\r\nusing System.Windows.Controls;\r\nusing System.Windows.Documents;\r\nusing System.Windows.Ink;\r\nusing System.Windows.Input;\r\nusing System.Windows.Media;\r\nusing System.Windows.Media.Animation;\r\nusing System.Windows.Shapes;\r\n\r\npublic class MouseInfo\r\n{\r\n    public double X { get; set; }\r\n    public double Y { get; set; }\r\n    public bool MouseDown { get; set; }\r\n}\r\npublic static class MouseMethods\r\n{\r\n    public static MouseInfo ToMouseInfo(this System.Windows.Input.MouseEventArgs e, object sender)\r\n    {\r\n        MouseInfo mi = new MouseInfo();\r\n        Point p = e.GetPosition(sender as UIElement);\r\n        mi.MouseDown = e.GetStylusPoints(sender as UIElement)[0].PressureFactor > 0;\r\n        mi.X = p.X;\r\n        mi.Y = p.Y;\r\n        return mi;\r\n    }\r\n}","MouseInfo mi = e.ToMouseInfo(sender);\r\n            if (mi.MouseDown)\r\n            {\r\n                mediatest.SetValue<double>(Canvas.LeftProperty, mi.X);\r\n                mediatest.SetValue<double>(Canvas.TopProperty, mi.Y);\r\n            }"]}