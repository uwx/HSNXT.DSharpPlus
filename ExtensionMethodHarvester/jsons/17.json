{"Name":"DataTable to CSV export","Description":"Export datatable to CSV file","Author":"John","SubmittedOn":"1/29/2010 3:41:06 PM","Entries":["public static void ToCSV(this DataTable table, string delimiter, bool includeHeader)\r\n        {\r\n\r\n            StringBuilder result = new StringBuilder();\r\n\r\n\r\n           \r\n            if (includeHeader)\r\n            {\r\n\r\n                foreach (DataColumn column in table.Columns)\r\n                {\r\n\r\n                    result.Append(column.ColumnName);\r\n\r\n                    result.Append(delimiter);\r\n\r\n                }\r\n\r\n\r\n\r\n                result.Remove(--result.Length, 0);\r\n\r\n                result.Append(Environment.NewLine);\r\n\r\n            }\r\n\r\n\r\n\r\n            foreach (DataRow row in table.Rows)\r\n            {\r\n\r\n                foreach (object item in row.ItemArray)\r\n                {\r\n\r\n                    if (item is System.DBNull)\r\n\r\n                        result.Append(delimiter);\r\n\r\n                    else\r\n                    {\r\n\r\n                        string itemAsString = item.ToString();\r\n\r\n                        // Double up all embedded double quotes\r\n\r\n                        itemAsString = itemAsString.Replace(\"\\\"\", \"\\\"\\\"\");\r\n\r\n\r\n\r\n                        // To keep things simple, always delimit with double-quotes\r\n\r\n                        // so we don't have to determine in which cases they're necessary\r\n\r\n                        // and which cases they're not.\r\n\r\n                        itemAsString = \"\\\"\" + itemAsString + \"\\\"\";\r\n\r\n\r\n\r\n                        result.Append(itemAsString + delimiter);\r\n\r\n                    }\r\n\r\n                }\r\n\r\n\r\n\r\n                result.Remove(--result.Length, 0);\r\n\r\n                result.Append(Environment.NewLine);\r\n\r\n            }\r\n\r\n\r\n            using (StreamWriter writer = new StreamWriter(@\"C:\\log.csv\", true))\r\n            {\r\n                writer.Write(result.ToString());\r\n                \r\n            }\r\n\r\n\r\n            \r\n\r\n        }","DataTable dataTableExportToCSV;\r\ndataTableExportToCSV.ToCSV (\",\",false);"]}