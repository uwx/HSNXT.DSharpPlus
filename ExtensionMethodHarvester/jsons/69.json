{"Name":"ToLogString","Description":"Creates a string for logging purposes from an Exception. Includes the InnerException(s), Stacktrace et cetera.","Author":"Mark de Rover","SubmittedOn":"1/2/2008 10:30:11 AM","Entries":["using System;\r\nusing System.Collections.Generic;\r\nusing System.Linq;\r\nusing System.Text;\r\nusing System.Security.Cryptography;\r\n\r\n    public static class Extensions\r\n    {\r\n\r\n        #region Exception.ToLogString\r\n        /// <summary>\r\n        /// <para>Creates a log-string from the Exception.</para>\r\n        /// <para>The result includes the stacktrace, innerexception et cetera, separated by <seealso cref=\"Environment.NewLine\"/>.</para>\r\n        /// </summary>\r\n        /// <param name=\"ex\">The exception to create the string from.</param>\r\n        /// <param name=\"additionalMessage\">Additional message to place at the top of the string, maybe be empty or null.</param>\r\n        /// <returns></returns>\r\n        public static string ToLogString(this Exception ex, string additionalMessage)\r\n        {\r\n            StringBuilder msg = new StringBuilder();\r\n\r\n            if (!string.IsNullOrEmpty(additionalMessage))\r\n            {\r\n                msg.Append(additionalMessage);\r\n                msg.Append(Environment.NewLine);\r\n            }\r\n\r\n            if (ex != null)\r\n            {\r\n                try\r\n                {\r\n                    Exception orgEx = ex;\r\n\r\n                    msg.Append(\"Exception:\");\r\n                    msg.Append(Environment.NewLine);\r\n                    while (orgEx != null)\r\n                    {\r\n                        msg.Append(orgEx.Message);\r\n                        msg.Append(Environment.NewLine);\r\n                        orgEx = orgEx.InnerException;\r\n                    }\r\n\r\n                    if (ex.Data != null)\r\n                    {\r\n                        foreach (object i in ex.Data)\r\n                        {\r\n                            msg.Append(\"Data :\");\r\n                            msg.Append(i.ToString());\r\n                            msg.Append(Environment.NewLine);\r\n                        }\r\n                    }\r\n\r\n                    if (ex.StackTrace != null)\r\n                    {\r\n                        msg.Append(\"StackTrace:\");\r\n                        msg.Append(Environment.NewLine);\r\n                        msg.Append(ex.StackTrace.ToString());\r\n                        msg.Append(Environment.NewLine);\r\n                    }\r\n\r\n                    if (ex.Source != null)\r\n                    {\r\n                        msg.Append(\"Source:\");\r\n                        msg.Append(Environment.NewLine);\r\n                        msg.Append(ex.Source);\r\n                        msg.Append(Environment.NewLine);\r\n                    }\r\n\r\n                    if (ex.TargetSite != null)\r\n                    {\r\n                        msg.Append(\"TargetSite:\");\r\n                        msg.Append(Environment.NewLine);\r\n                        msg.Append(ex.TargetSite.ToString());\r\n                        msg.Append(Environment.NewLine);\r\n                    }\r\n\r\n                    Exception baseException = ex.GetBaseException();\r\n                    if (baseException != null)\r\n                    {\r\n                        msg.Append(\"BaseException:\");\r\n                        msg.Append(Environment.NewLine);\r\n                        msg.Append(ex.GetBaseException());\r\n                    }\r\n                }\r\n                finally\r\n                {\r\n                }\r\n            }\r\n            return msg.ToString();\r\n        }\r\n        #endregion Exception.ToLogString\r\n    }","Exception ex = new Exception(“This is an error”);\r\nstring log = ex.ToLogString(“A fatal error occurred!”);"]}