{"Name":"FromIso8601WeekNumber / ToIso8601WeekNumber","Description":"Converts to and from ISO 8601 Week numbers","Author":"Bart Kemps","SubmittedOn":"12/6/2016 4:56:48 PM","Entries":["/// <summary>\r\n/// Converts a date to a week number.\r\n/// ISO 8601 week 1 is the week that contains the first Thursday that year.\r\n/// </summary>\r\npublic static int ToIso8601Weeknumber(this DateTime date)\r\n{\r\n    var thursday = date.AddDays(3 - date.DayOfWeek.DayOffset());\r\n    return (thursday.DayOfYear - 1) / 7 + 1;\r\n}\r\n\r\n/// <summary>\r\n/// Converts a week number to a date.\r\n/// Note: Week 1 of a year may start in the previous year.\r\n/// ISO 8601 week 1 is the week that contains the first Thursday that year, so\r\n/// if December 28 is a Monday, December 31 is a Thursday,\r\n/// and week 1 starts January 4.\r\n/// If December 28 is a later day in the week, week 1 starts earlier.\r\n/// If December 28 is a Sunday, it is in the same week as Thursday January 1.\r\n/// </summary>\r\npublic static DateTime FromIso8601Weeknumber(int weekNumber, int? year = null, DayOfWeek day = DayOfWeek.Monday)\r\n{\r\n    var dec28 = new DateTime((year ?? DateTime.Today.Year) - 1, 12, 28);\r\n    var monday = dec28.AddDays(7 * weekNumber - dec28.DayOfWeek.DayOffset());\r\n    return monday.AddDays(day.DayOffset());\r\n}\r\n\r\n/// <summary>\r\n/// Iso8601 weeks start on Monday. This returns 0 for Monday.\r\n/// </summary>\r\nprivate static int DayOffset(this DayOfWeek weekDay)\r\n{\r\n    return ((int)weekDay + 6) % 7;\r\n}","var week = new DateTime(2017,1,1).ToIso8601WeekNumber(); // yields 52\r\n\r\nvar date = FromIso8601Weeknumber(52, 2016, DayOfWeek.Sunday); // yields 1 jan 2017\r\n\r\nThis is correct: week 52 of 2016 stretches into 2017"]}