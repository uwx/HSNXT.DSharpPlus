{"Name":"GetValue","Description":"A bunch of extensions that work with SearchResult to retrieve its data.","Author":"john Simons","SubmittedOn":"6/17/2010 8:01:30 AM","Entries":["public static T GetValue<T>(this SearchResult result, string key)\r\n        {\r\n            return result.GetValue(key, default(T));\r\n        }\r\n\r\n        public static T GetValue<T>(this SearchResult result, string key, T defaultValue)\r\n        {\r\n            if (!result.Properties.Contains(key))\r\n            {\r\n                return defaultValue;\r\n            }\r\n\r\n            var resultPropertyValueCollection = result.Properties[key];\r\n            if (resultPropertyValueCollection.Count == 0)\r\n            {\r\n                return defaultValue;\r\n                \r\n            }\r\n\r\n            return (T) resultPropertyValueCollection[0];\r\n        }\r\n\r\n        public static IEnumerable<T> GetEnumerable<T>(this SearchResult result, string key)\r\n        {\r\n            if (!result.Properties.Contains(key))\r\n            {\r\n                yield break;\r\n            }\r\n\r\n            var values = result.Properties[key];\r\n\r\n\r\n            foreach (var value in values)\r\n            {\r\n                var valueCollection = value as T[];\r\n                if (valueCollection != null)\r\n                {\r\n                    foreach (var innerValue in valueCollection)\r\n                    {\r\n                        yield return innerValue;\r\n                    }\r\n                    yield break;\r\n                }\r\n                yield return (T) value;\r\n            }\r\n        }\r\n\r\n        public static SecurityIdentifier GetObjectSid(this SearchResult result)\r\n        {\r\n            if (result.Properties[\"objectSid\"].Count > 0)\r\n            {\r\n                var binaryForm = (byte[])result.Properties[\"objectSid\"][0];\r\n                return new SecurityIdentifier(binaryForm, 0);\r\n            }\r\n\r\n            return null;\r\n        }\r\n\r\n        public static Guid? GetObjectGuid(this SearchResult result)\r\n        {\r\n            if (result.Properties[\"objectGuid\"].Count == 1)\r\n            {\r\n                var b = (byte[])result.Properties[\"objectGuid\"][0];\r\n                return new Guid(b);\r\n            }\r\n\r\n            return null;\r\n        }","result.GetValue(\"sAMAccountName\", String.Empty)"]}