{"Name":"Perason Correlation Coefficient for a datatable","Description":"An extension method that add the possibility calculate the Pearson correlation coefficient using the names of two columns of the data table in question.","Author":"Mahmood Salamah","SubmittedOn":"8/26/2016 12:50:36 PM","Entries":["namespace System.Data\r\n{\r\n\tusing Collections.Generic;\r\n\r\n\tpublic static class DataTableExtensions\r\n\t{\r\n\t\tpublic static double PearsonCorrelate(this DataTable aSourceTable, string aColumn1, string aColumn2)\r\n\t\t{\r\n\t\t\tdouble dblResult = 0;\r\n\r\n\t\t\t// Buffer\r\n\t\t\tdouble tmpX = 0;\r\n\t\t\tdouble tmpY = 0;\r\n\r\n\t\t\t// These will be used in the Pearson correalation formula\r\n\t\t\tdouble X = 0;       // Sum of X\r\n\t\t\tdouble Y = 0;       // Sum of Y\r\n\t\t\tdouble XX = 0;      // Sum of X * X\r\n\t\t\tdouble YY = 0;      // Sum of Y * Y\r\n\t\t\tdouble XY = 0;      // Sum of X * Y\r\n\r\n\t\t\tint iRowCount = aSourceTable.Rows.Count;\r\n\r\n\t\t\tforeach (DataRow row in aSourceTable.Rows)\r\n\t\t\t{\r\n\t\t\t\ttmpX = Convert.ToDouble(row[aColumn1]);\r\n\t\t\t\ttmpY = Convert.ToDouble(row[aColumn2]);\r\n\r\n\t\t\t\tX += tmpX;\r\n\t\t\t\tY += tmpY;\r\n\r\n\t\t\t\tXX += tmpX * tmpX;\r\n\t\t\t\tYY += tmpY * tmpY;\r\n\t\t\t\tXY += tmpX * tmpY;\r\n\t\t\t}\r\n\r\n\t\t\tdblResult = (iRowCount * XY - X * Y) / Math.Sqrt((iRowCount * XX - X * X) * (iRowCount * YY - Y * Y));\r\n\r\n\t\t\treturn dblResult;\r\n\t\t}\r\n\t}\r\n}","DataTable tblWeather = GetWeatherInformation();\r\n\r\ndouble dblCorrelation = tblWeather.PearsonCorrelation(\"WindSpeed\" , \"Temperature\");"]}