{"Name":"AddWorkDays (fixed version)","Description":"Fixed version of AddWorkDays","Author":"Kevin Cook","SubmittedOn":"5/20/2014 10:26:17 PM","Entries":["public static class DateTimeExtensions\r\n{\r\n    public static bool IsWeekday(this DayOfWeek dow)\r\n    {\r\n        switch (dow)\r\n        {\r\n            case DayOfWeek.Sunday:\r\n            case DayOfWeek.Saturday:\r\n                return false;\r\n\r\n            default:\r\n                return true;\r\n        }\r\n    }\r\n\r\n    public static bool IsWeekend(this DayOfWeek dow)\r\n    {\r\n        return !dow.IsWeekday();\r\n    }\r\n        \r\n    public static DateTime AddWorkdays(this DateTime startDate, int days)\r\n    {\r\n        // start from a weekday        \r\n        while (startDate.DayOfWeek.IsWeekend())\r\n            startDate = startDate.AddDays(1.0);\r\n\r\n        for (int i = 0; i < days; ++i)\r\n        {\r\n            startDate = startDate.AddDays(1.0);\r\n\r\n            while (startDate.DayOfWeek.IsWeekend()) \r\n                startDate = startDate.AddDays(1.0);\r\n        }\r\n        return startDate;\r\n    }\r\n}","DateTime due = DateTime.Today.AddWorkdays(10); // due in 10 workdays\r\n\r\n//Fixed version"]}